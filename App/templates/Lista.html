{% extends "base.html" %}

{% block title %} Pokédex{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='Lista.css') }}">
{% endblock %}

{% block content %}

<h1>Pokédex de {{ trainer or 'Invitado' }}</h1>

<section class="galeria">

    {% for p in pokemon %}
    <div class="contenedor">
        <h2 style="margin-top: 6px;">{{ p.name }}</h2>
        
        <div class="image-container">
            <img src="{{ p.sprites.front_default }}" alt="{{ p.name }}" class="normal-img" />
            <img src="{{ p.sprites.front_shiny }}" alt="{{ p.name }} shiny" class="shiny-img" />
        </div>
        
        <div class="tipos">
            {% for tipo in p.types %}
                <img src="{{ url_for('static', filename='imagenes/' ~ tipo ~ '.png') }}" alt="{{ tipo }}" class="tipo-icono">
            {% endfor %}
        </div>
        
        {% if trainer %}
        <!-- Formulario de combate solo si hay entrenador -->
        <form method="post" action="{{ url_for('batalla') }}">
            <input type="hidden" name="pokemon" value="{{ p.name }}">
            <button type="submit">¡Combatir!</button>
        </form>
        {% else %}
        <p style="color: gray; font-style: italic;">Introduce tu nombre de entrenador para combatir</p>
        {% endif %}
        
    </div>
    {% endfor %}

</section>

<!-- Formulario alternativo de combate escribiendo el nombre -->
{% if trainer %}
<section class="contenedor-combate">
  <form method="post" action="{{ url_for('batalla') }}">
    <label for="pokemon">Escriba el nombre del Pokémon con el cual quiere combatir</label>
    <input type="text" id="pokemon" name="pokemon" required autofocus>
    <button type="submit" id="boton-start">Start</button>

    {% if errorCombate %}
      <p style="color: red; font-weight: bold; margin-top: 10px;">{{ errorCombate }}</p>
    {% endif %}
  </form>
</section>
{% endif %}

{% endblock %}
